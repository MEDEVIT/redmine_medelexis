h1. redmine_medelexis

A few goodies for the Medelexis MIS

* admin-users see the api_key of all users
* hooks are called after create/editing service tickets

h2. TODO

* Scripts for the hooks

h2. installation

bc. cd /path/to/redmine/plugins
git clone git@github.com:ngiger/redmine_medelexis.github
service restart redmine
[09:51:04] Marco Descher: FÃ¼r Admin user https://mis-beta.medelexis.ch/mmustermann/license.xml
[09:52:15] Marco Descher:  https://mis-beta.medelexis.ch/my/license - list of all service tickets
[09:52:23] Marco Descher:  https://mis-beta.medelexis.ch/my/license.xml - encrypted and signed license
[09:52:35] Marco Descher: https://mis-beta.medelexis.ch/mmustermann/license - list of all service tickets
[09:52:42] Marco Descher: https://mis-beta.medelexis.ch/mmustermann/license.xml -encrypted and signed license
Im logger IP-Adresse des Aufrufes abspeichern.

h2. configuration

Under http://foo.org/settings/plugin/redmine_medelexis you can add more debugging (to the default system logger) and to keep the temporary license files.

h2. Installation from scratch for development

Get the needed zip files. Used versions are found under https://mis-beta.medelexis.ch/admin/info
redmine-2.4.2.zip
redmine_contacts-3_2_13-pro.zip
redmine_contacts_helpdesk-2_2_8.zip
redmine_contacts_invoices-3_1_0-pro.zip
redmine_products-1_0_1-pro.zip

unzip redmine-*.zip
cd redmine-2.4.2
cd plugins
unzip redmine_contacts-*-pro.zip
unzip redmine_contacts_helpdesk-*.zip
unzip redmine_contacts_invoices-*.zip
unzip redmine_products-*.zip
# git clone https://github.com/thorin/redmine_ldap_sync
git clone git@github.com:ngiger/redmine_medelexis.git # or https://github.com/ngiger/redmine_medelexis.git
# use ruby 1.9
echo "gem 'yaml_db'" >> Gemfile
bundle install
bundle exec rake db:migrate RAILS_ENV=development
rake RAILS_ENV=development redmine:plugins NAME=redmine_contacts
rake RAILS_ENV=development redmine:plugins NAME=redmine_contacts_helpdesk
rake RAILS_ENV=development redmine:plugins NAME=redmine_contacts_invoices
rake RAILS_ENV=development redmine:plugins NAME=redmine_products
rake RAILS_ENV=development redmine:plugins NAME=redmine_medelexis
# rake RAILS_ENV=development redmine:plugins NAME=redmine_ldap_sync
# try loading the dump
rake RAILS_ENV=development db:data:load # loads db/data.yml. Had to remove entries for table tags
script/rails server webrick RAILS_ENV=production --port=30001 # start rails

To run the tests call
* @rake redmine:plugins:test NAME=redmine_medelexis@, which runs the test for all installed plugins.
Run tests for redmine_medelexis-plugins using
* @rake redmine:plugins:test NAME=redmine_medelexis@
* @ruby test/functional/license_test.rb@
* @ruby test/integration/license_test.rb@


h2. Create/installing dump from a server for deployment

Append a line @gem 'yaml_db'@ to the main Gemfile
rm -rf dump_output
bundle install
bundle exec rake db:data:dump_dir dir="dump_output"
rake db:data:dump_dir dir="redmine_dump" RAILS_ENV=production

install it with

h2. Resetting forgotten user password

RAILS_ENV=development bundle exec rails console
user = User.find_by_login('admin') ; user.password, user.password_confirmation = "adminadmin"; user.save!

# you might also use User.find_by_login('admin')

# user passwords must be at least 8 characters ong